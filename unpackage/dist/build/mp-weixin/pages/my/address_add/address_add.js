(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/my/address_add/address_add"],{"2a9b":function(e,t,n){"use strict";(function(e){var a=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n("2eee")),r=a(n("c973")),u=a(n("448a")),s=a(n("9523")),o=n("db75"),d=n("26cb");function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){(0,s.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var m={data:function(){return{checked:!0,change:"",id:"",name:"",phone:"",region:[],address:"",show_default:!1,is_default:!1,loading:!1,loaded:!1,items:[],multiIndex:[0,0,0],multiIds:[],newArr:[[],[],[]]}},onLoad:function(t){this.change=t.change||"",t.id?(e.setNavigationBarTitle({title:"编辑收货地址"}),this.id=t.id):this.show_default=!0,this.loadData()},computed:l({},(0,d.mapState)({user_address_list:function(e){return e.user_address.address_list}})),methods:{onDefaultChange:function(e){this.is_default=e.detail.value},bindRegionChange:function(e){console.log("picker发送选择改变，携带值为",e.detail),this.region=e.detail.value},bindMutilPickerChange:function(e){var t=this;console.log(e),console.log(this.multiIndex);this.items.map((function(e,n){t.multiIndex[0]===n&&(t.multiIds[0]=l({},e),e.subs.map((function(e,n){t.multiIndex[1]===n&&(t.multiIds[1]=l({},e),e.subs.map((function(e,n){t.multiIndex[2]===n&&(t.multiIds[2]=l({},e))})))})))})),console.log(this.multiIds),this.$forceUpdate()},bindMutilPickerColumnChange:function(e){var t=this,n={newArr:this.newArr,multiIndex:this.multiIndex};n.multiIndex[e.detail.column]=e.detail.value;var a=function(){var e=[],a=[];t.items.map((function(t,i){n.multiIndex[0]===i&&t.subs.map((function(t,i){e.push(t.name),n.multiIndex[1]===i&&t.subs.map((function(e,t){a.push(e.name)}))}))})),n.newArr[1]=e,n.newArr[2]=a};switch(e.detail.column){case 0:n.multiIndex[1]=0,n.multiIndex[2]=0,a();break;case 1:n.multiIndex[2]=0,a();break;case 2:a();break}this.newArr=n.newArr,this.multiIndex=(0,u.default)(n.multiIndex),this.$forceUpdate()},buildRegions:function(e){this.items=e;var t={arr:[],arr1:[],arr2:[],arr3:[]};e.map((function(e,n){t.arr1.push(e.name),t.arr2.length<=0&&e.subs.map((function(e,n){t.arr2.push(e.name),t.arr3.length<=0&&e.subs.map((function(e,n){t.arr3.push(e.name)}))}))})),t.arr[0]=t.arr1,t.arr[1]=t.arr2,t.arr[2]=t.arr3,this.newArr=t.arr,console.log(this.newArr),console.log(this.multiIndex)},loadData:function(){var e=this;return(0,r.default)(i.default.mark((function t(){var n,a,r;return i.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,o.axios.get("/api/v1/goods/region");case 3:if(n=t.sent,1===n.code){t.next=6;break}throw new Error("城市数据获取失败");case 6:if(e.buildRegions(n.data),!e.id){t.next=20;break}return t.next=10,o.axios.get("/api/v1/user/address/"+e.id);case 10:if(a=t.sent,1===a.code){t.next=13;break}throw new Error("收货地址获取失败");case 13:e.name=a.data.name,e.phone=a.data.phone,e.address=a.data.address,r={multiIndex:(0,u.default)(e.multiIndex),multiIds:(0,u.default)(e.multiIds),arr2:[],arr3:[]},e.items.map((function(e,t){e.name===a.data.province&&(r.multiIndex[0]=t,r.multiIds[0]=l({},e),e.subs.map((function(e,t){r.arr2.push(e.name),e.name===a.data.city&&(r.multiIndex[1]=t,r.multiIds[1]=l({},e),e.subs.map((function(e,t){r.arr3.push(e.name),e.name===a.data.area&&(r.multiIndex[2]=t,r.multiIds[2]=l({},e))})))})))})),3===r.multiIds.length&&(e.multiIndex=r.multiIndex,e.multiIds=r.multiIds,e.newArr[1]=r.arr2,e.newArr[2]=r.arr3,e.$forceUpdate()),e.show_default=1!==a.data.is_default;case 20:e.loaded=!0,t.next=26;break;case 23:t.prev=23,t.t0=t["catch"](0),console.log(t.t0);case 26:case"end":return t.stop()}}),t,null,[[0,23]])})))()},deleteAddress:function(){var t=this;e.showModal({title:"提示",content:"确定删除此地址?",showCancel:!0,cancelText:"取消",cancelColor:"#000030",confirmText:"确定",confirmColor:"#3CC51F",success:function(n){n.confirm&&o.axios.delete("/api/v1/user/address/"+t.id).then((function(n){1===n.code?(t.$u.toast(n.info,1200),setTimeout((function(){e.navigateBack()}),1200)):e.$u.toast("网络错误，请稍后再试！")})).catch((function(t){e.$u.toast("网络错误，请稍后再试！")}))}})},submit:function(){var t=this;if(!1!==this.loading)return!1;this.loading=!0,o.axios.post("/api/v1/user/address",{id:this.id,name:this.name,phone:this.phone,address:this.address,province:this.multiIds[0].name,city:this.multiIds[1].name,area:this.multiIds[2].name,is_default:this.is_default?"1":"0"}).then((function(n){1===n.code?(t.$u.toast(n.info,1200),t.$store.commit("user_address/update_user_address_list",{address_list:[].concat((0,u.default)(t.user_address_list),[n.data])}),setTimeout((function(){""!==t.change?(t.$store.commit("user_address/update_user_address_active",{id:n.data.id}),e.navigateBack({delta:2})):e.navigateBack()}),1200)):t.$u.toast(n.info,1200)})).catch((function(e){t.$u.toast("出错了，请稍后重试!",1200)})).finally((function(){t.loading=!1}))}}};t.default=m}).call(this,n("543d")["default"])},"3b51":function(e,t,n){"use strict";var a=n("7458"),i=n.n(a);i.a},"4a49":function(e,t,n){"use strict";(function(e,t){var a=n("4ea4");n("be30");a(n("66fd"));var i=a(n("e256"));e.__webpack_require_UNI_MP_PLUGIN__=n,t(i.default)}).call(this,n("bc2e")["default"],n("543d")["createPage"])},7458:function(e,t,n){},"9e7e":function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return a}));var a={uLoadingPage:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-loading-page/u-loading-page")]).then(n.bind(null,"8282"))},uIcon:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-icon/u-icon")]).then(n.bind(null,"4a55"))},uLine:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-line/u-line")]).then(n.bind(null,"4bfd"))},uButton:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-button/u-button")]).then(n.bind(null,"4005"))}},i=function(){var e=this.$createElement,t=(this._self._c,this.loaded?this.multiIds.length:null);this.$mp.data=Object.assign({},{$root:{g0:t}})},r=[]},d652:function(e,t,n){"use strict";n.r(t);var a=n("2a9b"),i=n.n(a);for(var r in a)["default"].indexOf(r)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(r);t["default"]=i.a},e256:function(e,t,n){"use strict";n.r(t);var a=n("9e7e"),i=n("d652");for(var r in i)["default"].indexOf(r)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(r);n("3b51");var u=n("f0c5"),s=Object(u["a"])(i["default"],a["b"],a["c"],!1,null,"0aa523ac",null,!1,a["a"],void 0);t["default"]=s.exports}},[["4a49","common/runtime","common/vendor"]]]);